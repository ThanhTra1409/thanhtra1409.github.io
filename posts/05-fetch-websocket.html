<!doctype html>

<html lang="vi">

<head>

  <meta charset="utf-8">

  <meta name="viewport" content="width=device-width,initial-scale=1">

  <title>Fetch API và WebSocket trên trình duyệt - Nguyễn Thanh Trà</title>

  <link rel="icon" type="image/x-icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>ðŸ‘¨"€ðŸ’»</text></svg>>

  <link rel="stylesheet" href="/css/style.css">

  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">

  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">

</head>

<body>

  <div class="overlay" id="overlay">

    <ul class="menu">

      <li><a href="/" data-i18n="home">Home</a></li>

      <li><a href="/posts/" data-i18n="blog">Blog</a></li>

      <li><a href="/about/" data-i18n="about">About</a></li>

    </ul>

  </div>

  <header>

    <nav>

      <div class="brand"><a href="/" data-i18n="site-title">Nguyễn Thanh Trà</a></div>

      <ul>

        <li><a href="/" data-i18n="home">Home</a></li>

        <li><a href="/posts/" data-i18n="blog">Blog</a></li>

        <li><a href="/about/" data-i18n="about">About</a></li>

        <li class="lang-toggle-wrapper">

          <div id="lang-switch" class="lang-switch" data-lang="vi">

            <div class="lang-switch-slider"></div>

            <button id="lang-vn" class="lang-btn">VN</button>

            <button id="lang-en" class="lang-btn">EN</button>

          </div>

        </li>

      </ul>

      <div class="menu-toggle" onclick="toggleMenu()" aria-label="menu">˜°</div>

    </nav>

  </header>

  <main>

    <article class="post">

      <h1>Fetch API và WebSocket trên trình duyệt</h1>

      <p class="meta">2025-12-07</p>

      <div class="featured-image"><img src="https://images.unsplash.com/photo-1555066931-4365d14bab8c?w=800&auto=format&fit=crop" alt="Fetch API và WebSocket trên trình duyệt"></div>

      <p>Trong phát triển web hiện đại, việc giao tiếp giữa client và server là thiết yếu. JavaScript cung cấp hai công cụ chính: <strong>Fetch API</strong> cho các yêu cầu HTTP thông thường và <strong>WebSocket</strong> cho giao tiếp hai chiều realtime.</p>
<p>Bài viết này sẽ giới thiệu cả hai công nghệ, phân biệt khi nào nên dùng cái nào, và cách sử dụng chúng trong ứng dụng thực tế.</p>
<img src="https://images.unsplash.com/photo-1555066931-4365d14bab8c?w=1200&auto=format&fit=crop" alt="Web Communication" style="max-width: 100%; height: auto; border-radius: 8px; margin: 20px 0;">
<h3>1. Fetch API - HTTP Request Hiện Đại</h3>
<p>Fetch API thay thế XMLHttpRequest cũ, cung cấp cú pháp đơn giản hơn và sử dụng Promise.</p>
<h4>GET Request cơ bản</h4>
<p>```javascript<br/>// GET request đơn giản<br/>fetch('https://jsonplaceholder.typicode.com/posts/1')<br/>  .then(response => response.json())<br/>  .then(data => console.log(data))<br/>  .catch(error => console.error('Lỗi:', error));</p>
<p>// Sử dụng async/await<br/>async function fetchPost() {<br/>  try {<br/>    const response = await fetch(<br/>      'https://jsonplaceholder.typicode.com/posts/1'<br/>    );</p>
<p>if (!response.ok) {<br/>      throw new Error(<code>HTTP error! status: ${response.status}</code>);<br/>    }</p>
<p>const data = await response.json();<br/>    console.log(data);<br/>  } catch (error) {<br/>    console.error('Lỗi:', error);<br/>  }<br/>}</p>
<p>fetchPost();<br/>```</p>
<h4>POST Request với JSON</h4>
<p>```javascript<br/>async function createPost() {<br/>  try {<br/>    const response = await fetch(<br/>      'https://jsonplaceholder.typicode.com/posts',<br/>      {<br/>        method: 'POST',<br/>        headers: {<br/>          'Content-Type': 'application/json',<br/>        },<br/>        body: JSON.stringify({<br/>          title: 'Bài viết mới',<br/>          body: 'Nội dung bài viết',<br/>          userId: 1<br/>        })<br/>      }<br/>    );</p>
<p>const data = await response.json();<br/>    console.log('Tạo thành công:', data);<br/>  } catch (error) {<br/>    console.error('Lỗi:', error);<br/>  }<br/>}<br/>```</p>
<h4>Xử lý Headers và Authentication</h4>
<p>```javascript<br/>async function fetchWithAuth() {<br/>  const response = await fetch('https://api.example.com/data', {<br/>    method: 'GET',<br/>    headers: {<br/>      'Authorization': 'Bearer YOUR_TOKEN',<br/>      'Content-Type': 'application/json'<br/>    }<br/>  });</p>
<p>// Đọc headers từ response<br/>  console.log('Content-Type:', response.headers.get('Content-Type'));</p>
<p>return await response.json();<br/>}<br/>```</p>
<h4>Upload File</h4>
<p>```javascript<br/>async function uploadFile(file) {<br/>  const formData = new FormData();<br/>  formData.append('file', file);<br/>  formData.append('description', 'Mô tả file');</p>
<p>try {<br/>    const response = await fetch('https://api.example.com/upload', {<br/>      method: 'POST',<br/>      body: formData<br/>      // Không set Content-Type, browser tự động set<br/>    });</p>
<p>const result = await response.json();<br/>    console.log('Upload thành công:', result);<br/>  } catch (error) {<br/>    console.error('Lỗi upload:', error);<br/>  }<br/>}</p>
<p>// Sử dụng<br/>const fileInput = document.querySelector('input[type="file"]');<br/>fileInput.addEventListener('change', (e) => {<br/>  const file = e.target.files[0];<br/>  if (file) {<br/>    uploadFile(file);<br/>  }<br/>});<br/>```</p>
<h3>2. WebSocket - Giao tiếp Realtime</h3>
<p>WebSocket cung cấp kênh giao tiếp hai chiều, full-duplex giữa client và server.</p>
<h4>Kết nối WebSocket cơ bản</h4>
<p>```javascript<br/>// Tạo kết nối WebSocket<br/>const ws = new WebSocket('ws://localhost:8080');</p>
<p>// Sự kiện khi kết nối thành công<br/>ws.onopen = (event) => {<br/>  console.log('Kết nối WebSocket thành công');<br/>  ws.send('Xin chào server!');<br/>};</p>
<p>// Sự kiện khi nhận tin nhắn<br/>ws.onmessage = (event) => {<br/>  console.log('Nhận tin nhắn:', event.data);<br/>};</p>
<p>// Sự kiện khi có lỗi<br/>ws.onerror = (error) => {<br/>  console.error('Lỗi WebSocket:', error);<br/>};</p>
<p>// Sự kiện khi ngắt kết nối<br/>ws.onclose = (event) => {<br/>  console.log('Kết nối đóng. Code:', event.code);<br/>};</p>
<p>// Gửi tin nhắn<br/>function sendMessage(message) {<br/>  if (ws.readyState === WebSocket.OPEN) {<br/>    ws.send(message);<br/>  } else {<br/>    console.error('WebSocket chưa sẵn sàng');<br/>  }<br/>}</p>
<p>// Đóng kết nối<br/>function closeConnection() {<br/>  ws.close();<br/>}<br/>```</p>
<h4>Ứng dụng Chat đơn giản</h4>
<p>```javascript<br/>class ChatClient {<br/>  constructor(url) {<br/>    this.ws = new WebSocket(url);<br/>    this.setupEventHandlers();<br/>  }</p>
<p>setupEventHandlers() {<br/>    this.ws.onopen = () => {<br/>      console.log('Kết nối chat thành công');<br/>      this.updateStatus('online');<br/>    };</p>
<p>this.ws.onmessage = (event) => {<br/>      const message = JSON.parse(event.data);<br/>      this.displayMessage(message);<br/>    };</p>
<p>this.ws.onerror = (error) => {<br/>      console.error('Lỗi:', error);<br/>      this.updateStatus('error');<br/>    };</p>
<p>this.ws.onclose = () => {<br/>      console.log('Đã ngắt kết nối');<br/>      this.updateStatus('offline');<br/>      // Tự động kết nối lại sau 5 giây<br/>      setTimeout(() => this.reconnect(), 5000);<br/>    };<br/>  }</p>
<p>sendMessage(text, username) {<br/>    const message = {<br/>      type: 'message',<br/>      username: username,<br/>      text: text,<br/>      timestamp: new Date().toISOString()<br/>    };</p>
<p>this.ws.send(JSON.stringify(message));<br/>  }</p>
<p>displayMessage(message) {<br/>    const messageDiv = document.createElement('div');<br/>    messageDiv.className = 'message';<br/>    messageDiv.innerHTML = <code><br/>      <strong>${message.username}</strong>: ${message.text}<br/>      <span class="time">${new Date(message.timestamp).toLocaleTimeString()}</span><br/>    </code>;</p>
<p>document.getElementById('messages').appendChild(messageDiv);<br/>  }</p>
<p>updateStatus(status) {<br/>    const statusEl = document.getElementById('status');<br/>    statusEl.textContent = status;<br/>    statusEl.className = <code>status-${status}</code>;<br/>  }</p>
<p>reconnect() {<br/>    console.log('Đang kết nối lại...');<br/>    this.ws = new WebSocket(this.ws.url);<br/>    this.setupEventHandlers();<br/>  }<br/>}</p>
<p>// Sử dụng<br/>const chat = new ChatClient('ws://localhost:8080');</p>
<p>document.getElementById('sendBtn').addEventListener('click', () => {<br/>  const input = document.getElementById('messageInput');<br/>  const username = document.getElementById('username').value;</p>
<p>if (input.value.trim()) {<br/>    chat.sendMessage(input.value, username);<br/>    input.value = '';<br/>  }<br/>});<br/>```</p>
<h4>Gửi/Nhận Binary Data</h4>
<p>```javascript<br/>// Gửi binary data<br/>const buffer = new ArrayBuffer(8);<br/>const view = new DataView(buffer);<br/>view.setInt32(0, 42);<br/>ws.send(buffer);</p>
<p>// Nhận binary data<br/>ws.binaryType = 'arraybuffer';<br/>ws.onmessage = (event) => {<br/>  if (event.data instanceof ArrayBuffer) {<br/>    const view = new DataView(event.data);<br/>    console.log('Nhận số:', view.getInt32(0));<br/>  }<br/>};<br/>```</p>
<h3>3. So sánh Fetch và WebSocket</h3>
<p>| Tính năng | Fetch API | WebSocket |<br/>|---------|-----------|----------|<br/>| Giao thức | HTTP/HTTPS | WS/WSS |<br/>| Kết nối | Request-Response | Full-duplex |<br/>| Realtime | Không | Có |<br/>| Overhead | Cao (mỗi request) | Thấp (một kết nối) |<br/>| Sử dụng cho | REST API, CRUD | Chat, Notification, Game |</p>
<h3>4. Khi nào dùng gì?</h3>
<p><strong>Dùng Fetch API khi</strong>:<br/>- Cần gọi/nhận dữ liệu theo yêu cầu<br/>- Tương tác với REST API<br/>- Không cần realtime updates</p>
<p><strong>Dùng WebSocket khi</strong>:<br/>- Cần giao tiếp hai chiều realtime<br/>- Ứng dụng chat, live notifications<br/>- Game multiplayer, live dashboard<br/>- Cần latency thấp</p>
<p>Fetch API và WebSocket là hai công cụ quan trọng trong web development. Fetch API phù hợp cho các tác vụ HTTP thông thường, trong khi WebSocket thiết yếu cho ứng dụng realtime. Hiểu rõ ưu nhược điểm của mỗi công nghệ giúp bạn lựa chọn đúng trong từng tình huống.</p>
<p>Trong bài tiếp theo, chúng ta sẽ tìm hiểu cách xây dựng TCP server với Node.js, nền tảng cho các ứng dụng realtime phia server.</p>
<p>---</p>
<h3>Tài liệu tham khảo</h3>
<p>- [MDN Fetch API](https://developer.mozilla.org/en-US/docs/Web/API/Fetch_API)<br/>- [MDN WebSocket API](https://developer.mozilla.org/en-US/docs/Web/API/WebSocket)<br/>- [JavaScript.info - Fetch](https://javascript.info/fetch)<br/>- [JavaScript.info - WebSocket](https://javascript.info/websocket)</p>

    </article>

    <section class="social-section">

      <div class="social-container">

        <h2 data-i18n="social-title">Xã hội</h2>

        <div class="social-grid">

          <a href="https://github.com/ThanhTra1409" target="_blank" class="social-card">

            <i class="fab fa-github social-icon"></i>

            <h3>GitHub</h3>

            <p>@nttra204</p>

          </a>

          <a href="https://www.facebook.com/nguyen.thanh.tra.970568?locale=vi_VN" target="_blank" class="social-card">

            <i class="fab fa-facebook social-icon"></i>

            <h3>Facebook</h3>

            <p>Nguy&#7877;n Thanh Tr&#224;</p>

          </a>

          <a href="https://www.instagram.com/nttra204_/?igsh=MXVlc3p1NG4zdnBidw%3D%3D&utm_source=qr" target="_blank" class="social-card">

            <i class="fab fa-instagram social-icon"></i>

            <h3>Instagram</h3>

            <p>@nttra204_</p>

          </a>

          <a href="https://www.linkedin.com/in/thanh-tra-nguyen-84a46833a" target="_blank" class="social-card">

            <i class="fab fa-linkedin social-icon"></i>

            <h3>LinkedIn</h3>

            <p>Nguy&#7877;n Thanh Tr&#224;</p>

          </a>

        </div>

      </div>

    </section>

  </main>

  <footer>

    <div class="footer-content">

      <div class="footer-brand">

        <h3 data-i18n="site-title">Nguyễn Thanh Trà</h3>

        <p class="footer-tagline" data-i18n="footer-tagline">Building scalable solutions with passion</p>

      </div>

      <div class="footer-contact">

        <h4 data-i18n="contact-info">Thông tin liên hệ</h4>

        <div class="contact-info-grid">

          <div class="contact-info-item">

            <i class="fas fa-envelope"></i>

            <a href="mailto:ntra140924@gmail.com">ntra140924@gmail.com</a>

          </div>

          <div class="contact-info-item">

            <i class="fas fa-phone"></i>

            <a href="tel:0941779093">0941779093</a>

          </div>

        </div>

      </div>

      <div class="footer-bottom">

        <p><span data-i18n="footer-copyright">© 2025</span> <span data-i18n="site-title">Nguyễn Thanh Trà</span></p>

      </div>

    </div>

  </footer>

  <script src="/js/i18n.js?v=1.1"></script>

  <script>

  function toggleMenu(){

    document.body.classList.toggle('menu-open');

  }

  </script>

</body>

</html>